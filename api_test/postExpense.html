<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>GAS Expense POST Test</title>
</head>
<body>
  <h2>GAS Expense POST Test</h2>

  <form method="POST"
        action="https://script.google.com/macros/s/AKfycbxdq4fcooY1RC-BH8v4Nw7NgoXiNSwp1DotEv2U2eqFmkGI2L9ZCH0FoXWAamVPt_Hm/exec"
        onsubmit="return buildPayload();">

    <div>
      <label>Date (YYYY-MM-DD):</label>
      <input id="date" type="text" value="2026-01-04">
    </div>

    <div>
      <label>Amount:</label>
      <input id="amount" type="number" step="0.01" value="1201.99">
    </div>

    <div>
      <label>Category:</label>
      <select id="category">
        <option value="dining_out">dining_out</option>
        <option value="groceries" selected>groceries</option>
      </select>
    </div>

    <div>
      <label>image_url:</label>
      <input id="image_url" type="text"
             value="https://drive.google.com/file/d/1HM-RXAYNv_XT5YqL9UpgwcfpXVYQGeDN/view?usp=drivesdk"
             size="120">
    </div>

    <div>
      <label>image_file_id:</label>
      <input id="image_file_id" type="text" value="1HM-RXAYNv_XT5YqL9UpgwcfpXVYQGeDN" size="60">
    </div>

    <input type="hidden" name="payload" id="payload">

    <button type="submit">POST 送信</button>
  </form>

  <pre id="preview"></pre>

  <script>
    function buildPayload() {
      const obj = {
        action: "expense",
        date: document.getElementById("date").value.trim(),
        amount: Number(document.getElementById("amount").value),
        category: document.getElementById("category").value,
        image_url: document.getElementById("image_url").value.trim(),
        image_file_id: document.getElementById("image_file_id").value.trim()
      };

      // 送信前に見やすくプレビュー（改行付き）
      document.getElementById("preview").textContent = JSON.stringify(obj, null, 2);

      // 送信は1行JSON（安全）
      document.getElementById("payload").value = JSON.stringify(obj);
      return true;
    }

    // 初期表示でプレビューも更新
    buildPayload();
  </script>
</body>
</html>

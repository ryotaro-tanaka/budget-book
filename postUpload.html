<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>GAS Upload Test</title>
</head>
<body>

<h2>Receipt Upload (base64)</h2>

<div>
  <label>Date (YYYY-MM-DD):</label>
  <input type="text" id="date" value="2026-01-03">
</div>

<div>
  <label>Amount:</label>
  <input type="number" id="amount" step="0.01" value="1201.00">
</div>

<div>
  <input type="file" id="file" accept="image/*">
</div>

<button onclick="send()">Upload</button>

<pre id="preview"></pre>

<script>
function send() {
  const file = document.getElementById("file").files[0];
  if (!file) { alert("ファイルを選択してください"); return; }

  const date = document.getElementById("date").value.trim();
  const amount = Number(document.getElementById("amount").value);

  const reader = new FileReader();
  reader.onload = () => {
    const base64 = reader.result.split(",")[1];

    const payload = {
      action: "upload",
      date: date,
      amount: amount,
      mime_type: file.type || "image/jpeg",
      base64: base64
    };

    document.getElementById("preview").textContent = JSON.stringify(payload, null, 2);

    const form = document.createElement("form");
    form.method = "POST";
    form.action = "https://script.google.com/macros/s/AKfycbxdq4fcooY1RC-BH8v4Nw7NgoXiNSwp1DotEv2U2eqFmkGI2L9ZCH0FoXWAamVPt_Hm/exec";

    const input = document.createElement("input");
    input.type = "hidden";
    input.name = "payload";
    input.value = JSON.stringify(payload);

    form.appendChild(input);
    document.body.appendChild(form);
    form.submit();
  };

  reader.readAsDataURL(file);
}
</script>

</body>
</html>

